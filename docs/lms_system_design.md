- **課題・テスト管理**
  - 課題作成・提出・採点機能
  - 自動採点機能（選択問題等）# 学習管理システム（LMS）概要設計書

## 1. システム概要

### 1.1 システム目的
- 学習活動の計画、実施、評価、管理を統合的に行う
- 学習進捗の可視化により学習意欲を向上させる
- ユーザー能力の分析により効果的な教育計画を策定する

### 1.2 技術スタック
- **フロントエンド**: React Router v7
- **バックエンド**: Node.js/Express（予定）
- **データベース**: PostgreSQL
- **インフラ**: Docker環境
- **開発環境**: ClaudeCode

## 2. システム構成

### 2.1 全体アーキテクチャ
```
[フロントエンド (React Router v7)]
           ↕ HTTP/REST API
[バックエンドAPI (Node.js/Express)]
           ↕ SQL
[データベース (PostgreSQL)]
```

### 2.2 Docker構成
- **frontend**: React Router v7アプリケーション
- **backend**: Node.js/Express API server
- **database**: PostgreSQL
- **nginx**: リバースプロキシ（本番環境）

## 3. ユーザー管理

### 3.1 ユーザーロール
- **一般ユーザー**: 学習者
- **管理ユーザー**: 教育者・管理者

### 3.2 認証・認可
- JWT認証
- ロールベースアクセス制御（RBAC）

## 4. 主要機能

### 4.1 学習管理機能
- **学習コース管理**
  - コース作成・編集・削除（管理者）
  - コース受講・進捗管理（一般ユーザー）
- **多様な学習教材管理**
  - **ファイル型教材**: PDF、動画、音声、プレゼンテーション等のアップロード・配信
  - **URL型教材**: 外部サイト・YouTube・オンライン教材へのリンク
  - **手動進捗管理**: 外部学習の進捗率を学習者が手入力
  - **補足リソース**: 関連ファイル・サイト・YouTube動画の提示
- **学習リソース管理**
  - メイン教材と補足リソースの階層管理
  - リソースタイプ別の表示・再生機能
  - 学習者向けリソース推奨機能

### 4.2 進捗管理・可視化機能
- **学習進捗ダッシュボード**
  - 個人の学習進捗率（自動計算 + 手動入力対応）
  - 学習時間の可視化
  - 達成度合いの表示
  - 教材タイプ別進捗状況
- **能力評価システム**
  - プログラミングスキルマップ（言語別、技術領域別）
  - 資格試験の習熟度レベル表示
  - 成長曲線の可視化
- **学習履歴管理**
  - アクセスした教材・リソースの履歴
  - 外部学習の進捗記録
  - 補足リソースの活用状況

### 4.3 テスト・問題管理機能
- **問題作成機能（管理者用）**
  - 選択問題（自動採点対応）
  - 記述問題（主観評価用）
  - プログラミング課題（コード提出・評価）
  - 問題カテゴリ管理（プログラミング言語別、資格試験別）
- **テスト実施機能**
  - 制限時間設定
  - 問題のランダム出題
  - 自動採点と手動採点の併用

### 4.4 ゲーミフィケーション機能
- **ポイントシステム**
  - 学習完了、テスト合格時のポイント獲得
  - 質問投稿・回答投稿でのポイント獲得
  - ベストアンサー選定時のボーナスポイント
  - 連続学習ボーナス（ストリーク）
- **バッジ・称号システム**
  - 達成度に応じたバッジ付与
  - プログラミング言語別、資格別の専門バッジ
  - Q&A貢献バッジ（質問王、回答王、ナレッジマスター等）
- **ランキング機能**
  - 月間学習時間ランキング
  - 分野別スコアランキング
  - Q&A貢献度ランキング
- **学習継続支援**
  - 学習カレンダー（連続学習日数の可視化）
  - 目標設定・達成追跡機能

### 4.5 分析・レポート機能
- **学習分析**
  - 学習パターン分析
  - 弱点・強みの特定
- **教育計画支援**
  - 個別学習推奨パス
  - 次の学習目標提案

### 4.6 Q&A・ナレッジ管理機能
- **質問投稿機能**
  - 学習者による質問投稿（コース・レッスン単位）
  - 質問の分類・タグ付け（プログラミング言語・技術分野別）
  - 添付ファイル対応（コード、スクリーンショット等）
- **回答機能**
  - 管理者・他学習者による回答投稿
  - ベストアンサー選定機能
  - 回答への評価（いいね・参考になった）
- **ナレッジベース化**
  - FAQ自動生成（よくある質問の抽出）
  - 質問・回答の検索機能
  - 関連質問の推奨表示
  - 学習教材との紐付け表示
- **管理機能**
  - Q&Aの公開・非公開設定
  - 不適切な投稿の管理・削除
  - ナレッジの整理・編集

### 4.7 コミュニケーション機能
- **掲示板・フォーラム**
- **メッセージング機能**
- **お知らせ・通知機能**

## 5. データベース設計（概要）

### 5.1 主要テーブル構成
- **users**: ユーザー情報（500名対応）
- **courses**: コース情報（プログラミング・資格試験分野）
- **lessons**: レッスン情報
- **learning_materials**: 学習教材管理
  - material_type: 'file', 'url', 'manual_progress'
  - file_path: ファイル型教材のパス
  - external_url: 外部URL
  - material_category: 'main', 'supplementary'
- **learning_resources**: 補足リソース管理
  - resource_type: 'file', 'website', 'youtube', 'document'
  - resource_url: リソースのURL
  - resource_description: リソースの説明
- **user_progress**: 学習進捗
  - progress_type: 'auto', 'manual'
  - manual_progress_rate: 手動入力進捗率
- **user_material_access**: 教材アクセス履歴
- **qa_questions**: Q&A質問管理
  - question_title: 質問タイトル
  - question_content: 質問内容
  - question_tags: タグ（プログラミング言語・分野別）
  - course_id, lesson_id: 関連する学習内容
  - is_public: 公開・非公開設定
  - view_count: 閲覧数
- **qa_answers**: Q&A回答管理
  - answer_content: 回答内容
  - is_best_answer: ベストアンサーフラグ
  - helpful_count: 参考になった評価数
- **qa_attachments**: Q&A添付ファイル管理
- **qa_votes**: Q&A評価管理（いいね・参考になった）
- **knowledge_base**: ナレッジベース
  - faq_category: FAQカテゴリ
  - search_keywords: 検索用キーワード
  - related_materials: 関連教材ID
- **questions**: 問題管理（選択問題・記述問題・プログラミング課題）
- **question_options**: 選択問題の選択肢
- **tests**: テスト定義
- **test_questions**: テストと問題の関連
- **user_test_results**: ユーザーテスト結果
- **user_answers**: ユーザー回答（主観評価・自動採点対応）
- **skills**: スキル定義（プログラミング言語・技術分野別）
- **user_skills**: ユーザースキルレベル
- **badges**: バッジ定義
- **user_badges**: ユーザー獲得バッジ
- **user_points**: ユーザーポイント履歴
- **learning_streaks**: 学習継続記録

## 6. UI/UX設計方針

### 6.1 デザインコンセプト
- **直感的な操作性**: 学習に集中できるシンプルなUI
- **モチベーション向上**: ゲーミフィケーション要素の導入
- **進捗の可視化**: グラフ・チャートによる視覚的フィードバック

### 6.2 主要画面構成
- **ダッシュボード**: 学習状況の概要表示
- **コース一覧・詳細**: 利用可能コースの表示・選択
- **学習画面**: 
  - ファイル型教材の表示・再生
  - 外部URL教材へのリンク表示
  - 手動進捗入力フォーム
  - 補足リソース一覧表示
  - 関連Q&A表示
- **Q&A画面**:
  - 質問一覧・検索・フィルタリング
  - 質問詳細・回答表示
  - 質問投稿・回答投稿フォーム
- **ナレッジベース**: FAQ・検索機能・関連教材表示
- **リソースライブラリ**: 補足教材・参考サイト・YouTube動画の一覧
- **進捗管理**: 詳細な進捗・分析表示
- **管理画面**: コース・ユーザー・教材・リソース・Q&A管理（管理者用）

## 7. 開発フェーズ

### Phase 1: 基盤構築
- Docker環境構築
- 基本認証システム
- データベース設計・構築
- 基本UI フレームワーク

### Phase 2: 基本機能実装
- ユーザー管理
- コース・レッスン管理
- 基本的な学習進捗機能

### Phase 3: 拡張機能実装
- 高度な分析機能
- 能力評価システム
- 教育計画支援機能

### Phase 4: テスト・最適化・運用準備
- 単体テスト・統合テストの充実
- Playwright E2Eテスト実装（MCPサーバー連携）
- パフォーマンス最適化
- セキュリティ強化
- 運用監視機能
- ドキュメント整備

## 8. 非機能要件

### 8.1 パフォーマンス
- レスポンス時間: 3秒以内
- 同時接続ユーザー数: 500人（想定ユーザー数に対応）
- データベース接続プール: 最適化

### 8.2 セキュリティ
- HTTPS通信
- パスワード暗号化（bcrypt）
- SQLインジェクション対策
- XSS対策
- CSRF対策
- ファイルアップロードセキュリティ（プログラミング課題用）

### 8.3 可用性・保守性
- 稼働率: 99.5%以上
- データバックアップ: 日次
- **保守性重視**:
  - 包括的なコメント記述
  - 関数・クラス単位でのドキュメント化
  - TypeScript使用によるコード品質向上
  - ESLint/Prettier設定による統一的なコードスタイル
  - 3名体制での運用を考慮した設計

## 9. 詳細技術仕様

### 9.1 フロントエンド技術スタック
- **React Router v7**: SPA構築
- **TypeScript**: 型安全性とコード品質向上
- **Tailwind CSS**: レスポンシブデザイン
- **Chart.js/Recharts**: 進捗可視化
- **React Query**: API状態管理
- **React Hook Form**: フォーム管理

### 9.2 バックエンド技術スタック
- **Node.js + Express**: REST API
- **TypeScript**: 型安全性確保
- **Prisma ORM**: PostgreSQLとの接続
- **JWT**: 認証トークン
- **bcrypt**: パスワード暗号化
- **Multer**: ファイルアップロード（教材・リソース管理）
- **Sharp**: 画像処理・最適化
- **FFmpeg**: 動画処理（オプション）
- **Jest**: テストフレームワーク

### 9.3 データベース設計詳細
- **PostgreSQL 14+**: メインデータベース
- **Redis**: セッション管理・キャッシュ（オプション）
- **インデックス最適化**: 500名規模に対応した検索性能
- **バックアップ戦略**: 日次フルバックアップ + 増分バックアップ

### 9.4 開発・運用支援
- **Docker Compose**: 開発環境統一
- **ESLint + Prettier**: コード品質管理
- **Swagger/OpenAPI**: API ドキュメント自動生成
- **Winston**: ログ管理
- **PM2**: プロセス管理（本番環境）

### 9.5 テスト戦略
- **単体テスト**: Jest（フロントエンド・バックエンド）
- **統合テスト**: Jest + Supertest（API テスト）
- **E2Eテスト**: Playwright（MCPサーバー連携）
  - 主要ユーザーフローの自動テスト
  - ログイン・学習・テスト受験・進捗確認のシナリオ
  - ファイル型教材のアップロード・表示テスト
  - 外部URL教材のリンク動作テスト
  - 手動進捗入力機能のテスト
  - 補足リソース表示・アクセステスト
  - Q&A投稿・回答・検索機能のテスト
  - ナレッジベース機能のテスト
  - ゲーミフィケーション機能のテスト
  - 管理者機能（問題作成・評価・教材管理・Q&A管理）のテスト
  - レスポンシブデザインのクロスブラウザテスト

## 10. 教材・リソース管理の詳細仕様

### 10.1 対応ファイル形式
- **動画**: MP4, WebM, AVI（ブラウザ対応形式に変換）
- **音声**: MP3, WAV, AAC
- **文書**: PDF, DOCX, PPTX
- **画像**: JPEG, PNG, SVG
- **アーカイブ**: ZIP（サンプルコード等）

### 10.2 外部リンク管理
- **URL検証**: リンク先の有効性チェック
- **YouTube統合**: 埋め込み表示対応
- **プレビュー機能**: リンク先の概要表示
- **アクセス追跡**: 外部リンクのクリック数記録

### 10.3 手動進捗管理
- **進捗率入力**: 0-100%のスライダー入力
- **学習時間入力**: 任意での学習時間記録
- **メモ機能**: 学習内容のメモ保存
- **完了報告**: 学習完了の明示的な報告機能

### 10.4 補足リソース機能
- **カテゴリ分類**: 参考書籍、関連サイト、動画、ツール等
- **難易度表示**: 初級・中級・上級の分類
- **推奨度**: 必須・推奨・参考の重要度表示
- **タグ機能**: プログラミング言語・技術分野でのタグ付け

## 11. Q&A・ナレッジ管理システムの詳細仕様

### 11.1 質問投稿機能
- **質問分類**: 技術的質問、学習方法、キャリア相談等
- **タグシステム**: プログラミング言語、フレームワーク、技術分野
- **関連教材の自動紐付け**: 現在学習中の教材との関連付け
- **添付ファイル対応**: コード、エラー画面、図表等（最大10MB）
- **緊急度設定**: 通常・至急の設定

### 11.2 回答・評価機能
- **マークダウン対応**: コードブロック、リンク等のリッチテキスト
- **ベストアンサー機能**: 質問者による選定
- **評価システム**: 参考になった・いいね評価
- **回答通知**: 質問者・フォロワーへの通知機能
- **専門家マーク**: 管理者・経験豊富なユーザーの識別

### 11.3 ナレッジベース機能
- **FAQ自動生成**: よく見られる質問の自動抽出
- **全文検索**: 質問・回答内容の横断検索
- **関連質問表示**: 類似質問の自動推奨
- **学習教材連携**: 教材ページからの関連Q&A表示
- **カテゴリ整理**: 技術分野・難易度別の整理

### 11.4 管理・モデレーション機能
- **コンテンツ管理**: 不適切投稿の管理・削除
- **公開設定**: 個別Q&Aの公開・非公開制御
- **ナレッジ編集**: FAQ・重要な質問の編集・整理
- **統計機能**: Q&A活用状況の分析
- **通知管理**: 質問・回答の通知設定

### 11.5 学習促進機能
- **学習前推奨Q&A**: レッスン開始前の関連質問表示
- **躓きポイント予測**: 過去のQ&Aから躓きやすい箇所を予測
- **復習用Q&A**: 学習完了後の理解度確認質問
- **コミュニティ形成**: 同じ分野を学ぶユーザー同士のQ&A交流

---

## 確定要件

- **対象ユーザー規模**: 500名程度
- **学習内容**: プログラミング関連、資格試験
- **評価方式**: 主観評価 + 自動採点（管理者による問題作成機能）
- **ゲーミフィケーション**: 学習意欲向上のための仕組みを導入
- **外部連携**: なし
- **UI対応**: レスポンシブ対応
- **言語**: 日本語のみ
- **運用体制**: 3名程度（コメント充実による保守性向上重視）